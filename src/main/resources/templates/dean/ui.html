<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.w3.org/1999/xhtml"
      xmlns:v-bind="http://www.w3.org/1999/xhtml" lang="en" data-textdirection="ltr" class="loading">
<head th:replace="fragments/layout :: head"></head>

<body data-open="click" data-menu="vertical-menu" data-col="2-columns" class="vertical-layout vertical-menu 2-columns menu-expanded fixed-navbar">
<style>
    .material-icons.center-fix {
        margin-left: -2px;
    }
</style>
<div th:fragment="content" th:replace="fragments/layout :: wrapper(pageId = 'dean', subPage = 'ui_page')" sec:authorize="hasRole('ROLE_DEAN_ADMIN')">
    <div class="container">
        <div th:replace="fragments/toolbar"></div>
        <div id="app">
            <div class="loading" v-if="mounting">
                <div class="md-progress">
                    <div class="indeterminate"></div>
                </div>
            </div>
            <div class="loaded" style="display: none" v-show="!mounting">
                <div class="row">
                    <div class="col-12 col-lg-3">
                        <div class="list-group">
                            <a v-for="section in sections" :href="'#' + section.title"
                               class="list-group-item list-group-item-action"
                               :class="[ { active: section.active } ]">
                                <div>{{ section.title }}</div>
                                <small>{{ section.description }}</small>
                            </a>
                        </div>
                    </div>
                    <div class="col-12 col-lg-9">
                        <div class="mui-panel text-center">
                            <div v-if="imagesLoading">
                                <div class="md-progress">
                                    <div class="indeterminate"></div>
                                </div>
                            </div>
                            <span v-for="image in images" :key="image.key" class="mr-1">
                                <img height="150px" width="150px" :src="image['.value']" alt="" class="img-thumbnail hover-cursor" @click="showImage(image)">
                            </span>
                            <div class="file-container">
                                <label class="mui-btn mui-btn--raised mui-btn--primary">
                                    <input :disabled="imageUpload.uploading" @change="filesChange($event.target.files)"
                                           class="upload-input" type="file" name="file" style="display: none" accept="image/*">
                                    <span>Upload Image</span>
                                </label>
                            </div>
                            <div v-if="uploadedFile">
                                <div class="alert alert-dismissible alert-success">
                                    <button type="button" class="close" data-dismiss="alert">&times;</button>
                                    <strong>Success!</strong>
                                    <span>Image uploaded successfully</span>
                                </div>
                                <img height="200px" :src="uploadedFile" /><br>
                                <button @click="save"
                                        class="mui-btn mui-btn--fab mui-btn--primary">
                                    <i class="material-icons md-24 md-light">save</i>
                                </button>
                            </div>
                            <div v-if="file">
                                <div v-if="!imageUri">
                                    Loading...
                                </div>
                                <div v-else>
                                    <img height="200px" :src="imageUri" /><br>
                                    <button v-if="!imageUpload.uploading" @click="upload"
                                            class="mui-btn mui-btn--fab mui-btn--primary">
                                        <i class="material-icons md-24 md-light">file_upload</i>
                                    </button>
                                </div>
                                <div v-if="imageUpload.uploading">
                                <span v-if="imageUpload.uploadTask">
                                    <button v-if="!imageUpload.paused" @click="pause"
                                            class="mui-btn mui-btn--small mui-btn--primary mui-btn--fab">
                                        <i class="material-icons md-18 md-light center-fix">pause</i>
                                    </button>
                                    <button v-if="imageUpload.paused" @click="resume"
                                            class="mui-btn mui-btn--small mui-btn--primary mui-btn--fab">
                                        <i class="material-icons md-18 md-light center-fix">play_arrow</i>
                                    </button>
                                    <button @click="cancel"
                                            class="mui-btn mui-btn--small mui-btn--primary mui-btn--fab">
                                        <i class="material-icons md-18 md-light center-fix">stop</i>
                                    </button>
                                </span>
                                    <span>{{ progress }} %</span>
                                    <span :hidden="imageUpload.paused" class="md-progress">
                                    <span class="indeterminate"></span>
                                </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal" role="dialog">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-body">
                                <img :src="imageToShow" alt="Image" style="width: 100%;">
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                <button type="button" class="btn btn-outline-danger" @click="deleteImage">Delete</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div th:replace="fragments/scripts :: firebase_database"></div>
<div th:replace="fragments/scripts :: firebase_storage"></div>
<div th:replace="fragments/scripts :: firebase_auth"></div>
<script src="https://cdn.jsdelivr.net/npm/vue@2.5.17/dist/vue.min.js"></script>
<script src="https://unpkg.com/vuefire@1.4.5/dist/vuefire.min.js"></script>
<script th:src="@{/js/build/ui.min.js}"></script>
</body>
</html>
